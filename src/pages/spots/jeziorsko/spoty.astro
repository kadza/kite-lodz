---
import { Layout } from '../../../components/Layout';
import { Head } from '../../../components/Head';
import type { NavLink } from '../../../components/Nav';

const navLinks: NavLink[] = [
  { href: '/', label: 'Kite Łódź' },
  { href: '/spots/jeziorsko/', label: 'Jeziorsko' },
];

const subNav: NavLink[] = [
 { href: '/spots/jeziorsko/spoty', label: 'Spoty', isActive: true },
 { href: '/spots/jeziorsko/popow', label: 'Popów' },
 { href: '/spots/jeziorsko/popow-polanka', label: 'Popów polanka' },
 { href: '/spots/jeziorsko/wylazlow', label: 'Wylazłów' },
 { href: '/spots/jeziorsko/brodnia-tama', label: 'Brodnia tama' },
 { href: '/spots/jeziorsko/brodnia-cypel', label: 'Brodnia cypel' },
 { href: '/spots/jeziorsko/ostrow', label: 'Ostrów Warcki' },
 { href: '/spots/jeziorsko/zaspy', label: 'Zaspy' },
 { href: '/spots/jeziorsko/milkowice', label: 'Miłkowice' },
 { href: '/spots/jeziorsko/skarpa', label: 'Skarpa' },
   { href: '/spots/jeziorsko/pogoda', label: 'Pogoda' }
 ];
---

<html lang="en" class="h-full">
  <head>
    <Head title="Spoty - Jeziorsko" />
  </head>
  <body class="h-full">
    <Layout navLinks={navLinks} subNav={subNav}>
   <div class="flex flex-col">
      <div class="w-full relative">
       <div id="map" class="h-[75vh] md:h-[45rem] w-full"></div>
      <button
        id="reset-map"
        class="absolute top-2 right-2 bg-white p-2 rounded-md shadow-md text-textColor hover:bg-gray-100 z-[1000]"
      >
        Reset
      </button>
    </div>
  </div>
</Layout>

<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
  crossOrigin=""
/>
<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
  crossOrigin=""
></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const menuBtn = document.getElementById("menu-btn");
    const mobileMenu = document.getElementById("mobile-menu");
    const closeMenuBtn = document.getElementById("close-mobile-menu");

    if (menuBtn && mobileMenu) {
      menuBtn.addEventListener("click", function () {
        mobileMenu.classList.toggle("hidden");
      });
    }

    if (closeMenuBtn && mobileMenu) {
      closeMenuBtn.addEventListener("click", function () {
        mobileMenu.classList.add("hidden");
      });
    }

    // Close menu when clicking on the overlay (but not on menu items)
    if (mobileMenu) {
      mobileMenu.addEventListener("click", function (event) {
        if (event.target === mobileMenu) {
          mobileMenu.classList.add("hidden");
        }
      });
    }

    const initialCenter = [51.82, 18.69];
    const initialZoom = 12;
    const map = L.map("map").setView(initialCenter, initialZoom);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: "© OpenStreetMap",
    }).addTo(map);

    const defaultIcon = new L.Icon.Default();
    const greenIcon = new L.Icon({
      iconUrl: "/assets/marker-icon-green.webp",
      shadowUrl: "/assets/marker-shadow.webp",
      iconSize: [25, 41],
      iconAnchor: [12, 41],
      popupAnchor: [1, -34],
      shadowSize: [41, 41],
    });

    const spots = {
      popow: {
        coords: [51.831492, 18.720963],
        elem: document.querySelector(`a[href="/spots/jeziorsko/popow"]`),
      },
      "popow-polanka": {
        coords: [51.828077, 18.718547],
        elem: document.querySelector(`a[href="/spots/jeziorsko/popow-polanka"]`),
      },
      wylazlow: {
        coords: [51.820756, 18.717871],
        elem: document.querySelector(`a[href="/spots/jeziorsko/wylazlow"]`),
      },
      skarpa: {
        coords: [51.837093, 18.719265],
        elem: document.querySelector(`a[href="/spots/jeziorsko/skarpa"]`),
      },
      "brodnia-tama": {
        coords: [51.794334, 18.700114],
        elem: document.querySelector(`a[href="/spots/jeziorsko/brodnia-tama"]`),
      },
      "brodnia-cypel": {
        coords: [51.796756, 18.684622],
        elem: document.querySelector(`a[href="/spots/jeziorsko/brodnia-cypel"]`),
      },
      ostrow: {
        coords: [51.803366, 18.660262],
        elem: document.querySelector(`a[href="/spots/jeziorsko/ostrow"]`),
      },
      zaspy: {
        coords: [51.822518, 18.668995],
        elem: document.querySelector(`a[href="/spots/jeziorsko/zaspy"]`),
      },
      milkowice: {
        coords: [51.831662, 18.673346],
        elem: document.querySelector(`a[href="/spots/jeziorsko/milkowice"]`),
      },
    };

    for (const spotName in spots) {
      const spot = spots[spotName];
      spot.marker = L.marker(spot.coords, { icon: defaultIcon })
        .addTo(map)
        .bindPopup(spot.elem.textContent);

      spot.marker.on("click", function (e) {
        map.setView(e.latlng, 18);
      });

      spot.marker.on("mouseover", function () {
        this.setIcon(greenIcon);
        spot.elem.classList.add("text-hoverColor");
      });

      spot.marker.on("mouseout", function () {
        this.setIcon(defaultIcon);
        spot.elem.classList.remove("text-hoverColor");
      });

      spot.elem.addEventListener("mouseover", function () {
        spot.marker.setIcon(greenIcon);
        spot.elem.classList.add("text-hoverColor");
      });

      spot.elem.addEventListener("mouseout", function () {
        spot.marker.setIcon(defaultIcon);
        spot.elem.classList.remove("text-hoverColor");
      });
    }

    document
      .getElementById("reset-map")
      .addEventListener("click", function () {
        map.setView(initialCenter, initialZoom);
        map.closePopup();
      });
  });
</script>
    </Layout>
  </body>
</html>
